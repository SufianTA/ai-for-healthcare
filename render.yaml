services:
  - name: surgitrack-api
    type: web
    plan: free          # <— forces free tier
    env: docker
    rootDir: backend
    dockerfilePath: Dockerfile
    dockerCommand: uvicorn app.main:app --host 0.0.0.0 --port $PORT
    envVars:
      - key: DATABASE_URL
        value: sqlite:///./surgitrack.db
      - key: JWT_SECRET
        generateValue: true
      - key: JWT_ALGORITHM
        value: HS256
      - key: JWT_EXPIRE_MINUTES
        value: "60"

  - name: surgitrack-web
    type: web
    plan: free          # <— forces free tier
    env: node
    rootDir: web
    buildCommand: npm install && npm run build
    startCommand: npm run start
    envVars:
      - key: NEXT_PUBLIC_API_BASE_URL
        value: https://REPLACE_WITH_API_HOST
